<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload Document - ClauseSpy</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #f8f9fa; display: flex; flex-direction: column; align-items: center; min-height: 100vh; margin: 0; }
        .user-header { width: 100%; padding: 10px 20px; text-align: right; box-sizing: border-box; }
        .user-header a { color: #007bff; text-decoration: none; font-weight: 500; }
        .container { text-align: center; padding: 2em; margin-top: 5em; }
        .upload-area { border: 2px dashed #ccc; border-radius: 10px; padding: 40px; }
        .file-label { display: inline-block; padding: 12px 20px; background-color: #007bff; color: white; border-radius: 5px; cursor: pointer; }
        input[type="file"] { display: none; }
        #file-name { margin-top: 15px; font-style: italic; color: #6c757d; }
        .submit-btn { background-color: #28a745; color: white; border: none; border-radius: 5px; padding: 12px 30px; margin-top: 20px; font-size: 1em; cursor: pointer; display: none; /* Hidden by default */ }
    </style>
</head>
<body>

    <div class="user-header">
         <p>Welcome, {{ current_user.username }}! <a href="{{ url_for('logout') }}">Logout</a></p>
    </div>

    <div class="container">
        <h2>Upload a Document for Analysis</h2>
        <p>Select a TXT, PDF, or DOCX file from your device.</p>
        
        <!-- The form now posts to the 'handle_upload' function -->
        <form action="{{ url_for('handle_upload') }}" method="post" enctype="multipart/form-data">
            <div class="upload-area">
                <label for="file" class="file-label">Choose File</label>
                <input type="file" name="file" id="file" accept=".txt,.pdf,.docx" required>
                <div id="file-name">No file selected</div>
            </div>
            <button type="submit" id="submit-button" class="submit-btn">Analyze Document</button>
        </form>
    </div>

    <script>
        const fileInput = document.getElementById('file');
        const fileNameDisplay = document.getElementById('file-name');
        const submitButton = document.getElementById('submit-button');

        fileInput.addEventListener('change', function() {
            if (this.files.length > 0) {
                // Show the file name in the "small box"
                fileNameDisplay.textContent = this.files[0].name;
                // Show the submit button
                submitButton.style.display = 'block';
            } else {
                fileNameDisplay.textContent = 'No file selected';
                submitButton.style.display = 'none';
            }
        });
    </script>

</body>
</html>
